/*!
 * Tiny Import from Word plugin
 *
 * Copyright (c) 2024 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 7.0.1-37
 */

!function(){"use strict";const t=t=>parseInt(t,10),r=(t,r)=>{const e=t-r;return 0===e?0:e>0?1:-1},e=(t,r,e)=>({major:t,minor:r,patch:e}),o=r=>{const o=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(r);return o?e(t(o[1]),t(o[2]),t(o[3])):e(0,0,0)};class n{constructor(t,r){this.tag=t,this.value=r}static some(t){return new n(!0,t)}static none(){return n.singletonNone}fold(t,r){return this.tag?r(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?n.some(t(this.value)):n.none()}bind(t){return this.tag?t(this.value):n.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:n.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(null!=t?t:"Called getOrDie on None")}static from(t){return null==t?n.none():n.some(t)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}n.singletonNone=new n(!1);const i=async(t,r)=>{const e=new FormData;return e.append("file",t,t.name),window.fetch(r,{method:"POST",body:e}).then((t=>t.json()))},s=t=>{t.addCommand("ImportWord",(()=>{(t=>{((t,r)=>{const e=(t=>n.from(t.options.get("importword_service_url")).getOrDie("The Import from Word plugin requires the importword_service_url to be configured"))(r),o=document.createElement("input");o.type="file",o.accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/msword, .doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",o.addEventListener("change",(async()=>{var n;const i=null===(n=o.files)||void 0===n?void 0:n.item(0);if(i){r.setProgressState(!0);try{const{html:o}=await t(i,e);r.insertContent(o),(t=>{t.dispatch("ImportFromWord")})(r)}catch(t){console.error(t),r.notificationManager.open({text:"Operation failed"})}finally{r.setProgressState(!1)}o.remove()}})),o.click()})(i,t)})(t)}))},a=(t,r)=>t.execCommand(r);tinymce.PluginManager.requireLangPack("importword","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hi,hr,hu_HU,id,it,ja,kk,ko_KR,ms,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,vi,zh_CN,zh_TW"),tinymce.PluginManager.add("importword",(t=>{((t,e)=>!!t&&-1===((t,e)=>{const o=r(t.major,e.major);if(0!==o)return o;const n=r(t.minor,e.minor);if(0!==n)return n;const i=r(t.patch,e.patch);return 0!==i?i:0})((t=>o((t=>[t.majorVersion,t.minorVersion].join(".").split(".").slice(0,3).join("."))(t)))(t),o(e)))(tinymce,"7.0")?console.error("The importword plugin requires at least version 7.0 of TinyMCE."):((t=>{t.options.register("importword_service_url",{processor:t=>{try{return new URL(t),{valid:!0,value:t}}catch(t){return{valid:!1,message:"The value provided in importword_service_url is not a valid URL"}}}})})(t),s(t),(t=>{t.ui.registry.addButton("importword",{tooltip:"Import from Word",icon:"import-word",onAction:()=>{a(t,"ImportWord")}})})(t),(t=>{t.ui.registry.addMenuItem("importword",{text:"Import from Word...",icon:"import-word",onAction:()=>a(t,"ImportWord")})})(t))}))}();